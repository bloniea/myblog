import{a as x,X as S,r as E,g as q,h as k,e as P,o as s,c as i,p as t,t as f,u as n,C as L,B as g,x as d,v as r,y as a,_ as R,$ as J,a0 as X,s as j,A as G,F as O,q as Q,L as W,M as Y,H as Z,K as tt,J as et,a1 as ot}from"./vendor.b1f7e7cf.js";/* empty css                */import{_ as st,f as nt}from"./index.5f53ded5.js";import{_ as C}from"./index.d7a63edd.js";const A=_=>(W("data-v-f6dda244"),_=_(),Y(),_),ct={class:"comments"},at={class:"title"},lt=A(()=>t("span",null,[r("\u652F\u6301 "),t("span",{class:"special"},"markdown"),r(" \u8BED\u6CD5")],-1)),it={class:"comments-box"},dt={class:"tip_login"},rt=r("\u767B\u5F55\u8FDB\u884C\u8BC4\u8BBA"),_t={class:"comment_form"},mt={key:1,class:"input",id:"commentInput"},ut={key:0,class:"to-user"},pt={class:"comments-input"},vt=["onKeyup"],ht={key:1,placeholder:"\u9884\u89C8",class:"shadow pre"},ft={class:"submit vsubmit"},gt=r("\u9884\u89C8"),yt=r("\u63D0\u4EA4"),wt={class:"list_box",ref:"commentsList"},kt={class:"avatar"},Ct={class:"comment-content bg-shadow"},It={class:"title-info"},bt={class:"username"},xt={class:"created"},St=["onClick"],Et=A(()=>t("i",{class:"iconfont iconreply"},null,-1)),Lt=[Et],At={key:0,class:"reply-content"},Nt={class:"name"},Tt={class:"content"},Bt={class:"content"},Vt={key:0,class:"add"},Ht=r("\u52A0\u8F7D\u66F4\u591A"),Dt={props:{comments:Array,total:Number,btnLoading:!1,addLoading:!1},emits:["saveComment","loadAdd"],setup(_,{emit:I}){const v=_,c=x({comments:[],previewContent:"\u9884\u89C8",commnetInput:""});S(()=>c.commnetInput,o=>c.previewContent=o||"\u9884\u89C8");const l=E(""),N=()=>{l.value="",l.value=""},m=x({content:"",to_user_id:null,level:1,to_comment_id:null}),T=()=>{if(l.value||(m.to_comment_id=null),!c.commnetInput)return Z.error("\u8BF7\u8F93\u5165\u8BC4\u8BBA\u5185\u5BB9");m.content=c.commnetInput,h.commit("setCommentIsNull",!1),I("saveComment",m)},B=o=>{window.location.href="#commentInput";const u=document.documentElement.scrollTop||document.body.scrollTop,p=document.documentElement.clientHeight||document.body.clientHeight;document.documentElement.scrollHeight,window.scrollTo(0,u-p/4),console.log(),m.to_comment_id=o._id,m.to_user_id=o.user_id,l.value=o.user.name},V=o=>{o.target.selectionStart||(l.value=""),m.level=1},h=q(),H=k(()=>h.state.userinfo),y=k(()=>h.state.status);S(()=>h.state.commentStatus,o=>o?c.commnetInput="":c.commnetInput);const w=E(!1),D=()=>{w.value=!w.value},K=k(()=>v.comments.length<v.total),U=()=>{I("loadAdd")},$=()=>{h.commit("setIsShowLogin",!0)},z=P(),F=()=>{z.push("/me")};return(o,u)=>{const p=tt,b=et,M=ot;return s(),i("div",ct,[t("div",at,[t("span",null,f(v.total)+"\u6761\u8BC4\u8BBA",1),lt]),t("div",it,[t("div",dt,[n(y)?d("",!0):(s(),L(p,{key:0,onClick:$},{default:g(()=>[rt]),_:1}))]),t("div",_t,[n(y)?(s(),L(b,{key:0,size:50,src:n(H).avatar_url,class:"user-avatar",onClick:F},null,8,["src"])):d("",!0),n(y)?(s(),i("div",mt,[l.value?(s(),i("div",ut,[r(" @"+f(l.value)+" ",1),a(M,{class:"close",onClick:N},{default:g(()=>[a(n(R))]),_:1})])):d("",!0),t("div",pt,[J(t("textarea",{rows:"4",type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u8BC4\u8BBA\u5185\u5BB9","onUpdate:modelValue":u[0]||(u[0]=e=>n(c).commnetInput=e),class:j(`shadow ${l.value?"is-reply":""}`),onKeyup:G(V,["delete"])},`\r
            `,42,vt),[[X,n(c).commnetInput]])]),w.value?(s(),i("div",ht,[a(C,{html:n(c).previewContent},null,8,["html"])])):d("",!0),t("div",ft,[a(p,{round:"",onClick:D},{default:g(()=>[gt]),_:1}),a(p,{round:"",onClick:u[1]||(u[1]=e=>T(o.ruleFormRef)),loading:v.btnLoading},{default:g(()=>[yt]),_:1},8,["loading"])])])):d("",!0)])]),t("div",wt,[(s(!0),i(O,null,Q(_.comments,e=>(s(),i("div",{class:"list",key:e._id},[t("div",kt,[a(b,{size:50,src:e.user.avatar_url},null,8,["src"])]),t("div",Ct,[t("div",It,[t("span",bt,f(e.user.name),1),t("span",xt,f(n(nt)(e.created_at)),1),t("span",{class:"reply",title:"\u56DE\u590D",onClick:Kt=>B(e)},Lt,8,St)]),e.to_comment&&e.to_comment_user?(s(),i("div",At,[t("div",Nt,"@"+f(e.to_comment_user.name),1),t("div",Tt,[a(C,{html:e.to_comment.content},null,8,["html"])])])):d("",!0),t("div",Bt,[a(C,{html:e.content},null,8,["html"])])])]))),128))],512),n(K)?(s(),i("div",Vt,[a(p,{onClick:U,loading:v.addLoading},{default:g(()=>[Ht]),_:1},8,["loading"])])):d("",!0)])}}};var Mt=st(Dt,[["__scopeId","data-v-f6dda244"]]);export{Mt as _};
