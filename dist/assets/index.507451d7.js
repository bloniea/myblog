import{a as I,m as F,U as P,V as j,o as l,c as m,u as o,r as S,h as G,i as B,f as J,e as t,t as v,D as E,y as N,W as Z,X as tt,v as et,B as st,z as _,C as z,F as O,s as W,J as X,K as Q,w as $,E as k,H as at,I as ot,g as nt,S as ct,G as lt}from"./vendor.999b5c7f.js";/* empty css                        */import{M as it}from"./index.d03a1f4f.js";/* empty css                                                          */import{_ as U,c as Y,f as D}from"./index.2e28db02.js";import{L as rt}from"./index.f190d37a.js";const dt=["innerHTML"],_t={props:{html:String},setup(u){const p=u,d=I({nHtml:String}),i=h=>F.parse(p.html,{renderer:new F.Renderer,highlight:function(c,f){const a=P.getLanguage(f)?f:"plaintext";return P.highlight(c,{language:a}).value},langPrefix:"hljs language-"});return d.nHtml=i(p.html),j(()=>p.html,h=>d.nHtml=i()),(h,c)=>(l(),m("div",{class:"md-to-html",innerHTML:o(d).nHtml},null,8,dt))}};var H=U(_t,[["__scopeId","data-v-5a5ebec8"]]);const q=u=>(X("data-v-236b2b8d"),u=u(),Q(),u),ut={class:"comments"},mt={class:"title"},vt=q(()=>t("span",null,[$("\u652F\u6301 "),t("span",{class:"special"},"markdown"),$(" \u8BED\u6CD5")],-1)),pt={class:"comments-box"},ht={class:"input"},ft={key:0,class:"to-user"},gt={class:"comments-input"},yt=["onKeyup"],$t={key:1,placeholder:"\u9884\u89C8",class:"shadow pre"},kt={class:"submit vsubmit"},wt=$("\u9884\u89C8"),xt=$("\u63D0\u4EA4"),Ct={class:"parent-comment"},bt={class:"comment-content bg-shadow"},It={class:"title-info"},St={class:"username"},Ht={class:"created"},At=["onClick"],jt=q(()=>t("i",{class:"iconfont iconreply"},null,-1)),Nt=[jt],zt={class:"content"},Dt={class:"comment-content bg-shadow"},Lt={class:"title-info"},Mt={class:"username"},Tt={class:"created"},Vt=["onClick"],Bt=q(()=>t("i",{class:"iconfont iconreply"},null,-1)),Et=[Bt],Ut={key:0,class:"to_user_info"},qt={class:"to_user_name"},Rt={class:"username"},Kt={class:"created"},Ft={class:"to_user_content"},Pt={class:"content"},Gt={key:0,class:"add"},Jt={props:{user:Object,comments:Array,total:Number},emits:["saveComment","loadAdd"],setup(u,{emit:p}){const d=u,i=I({comments:[],previewContent:"\u9884\u89C8",commnetInput:""});j(()=>i.commnetInput,r=>i.previewContent=r||"\u9884\u89C8");const h=S(""),c=I({content:"",to_user_id:null,level:1,to_comment_id:null}),f=()=>{if(h||(c.level=1,c.to_comment_id=null),!i.commnetInput)return k.error("\u8BF7\u8F93\u5165\u8BC4\u8BBA\u5185\u5BB9");c.content=i.commnetInput,y.commit("setCommentIsNull",!1),p("saveComment",c)},a=(r,g)=>{c.to_comment_id=r.id,c.to_user_id=r.user.id,c.level=g,h.value=r.user.name},A=r=>{r.target.selectionStart||(h.value="")},w=r=>{window.open(r)},y=G();j(()=>y.state.commentStatus,r=>r?i.commnetInput="":i.commnetInput);const x=S(!1),L=()=>{x.value=!x.value},M=B(()=>d.comments.length<d.total),T=()=>{p("loadAdd")},C=J(),V=()=>{C.push("/me")};return(r,g)=>{const b=at,e=ot;return l(),m("div",ut,[t("div",mt,[t("span",null,v(u.comments.length)+"\u6761\u8BC4\u8BBA",1),vt]),t("div",pt,[d.user?(l(),E(b,{key:0,size:50,src:d.user.avatar_url,class:"user-avatar",onClick:V},null,8,["src"])):(l(),E(b,{key:1,size:50,src:o(Y).avatar_default,class:"user-avatar"},null,8,["src"])),t("div",ht,[h.value?(l(),m("div",ft,"@"+v(h.value),1)):N("",!0),t("div",gt,[Z(t("textarea",{rows:"4",type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u8BC4\u8BBA\u5185\u5BB9","onUpdate:modelValue":g[0]||(g[0]=s=>o(i).commnetInput=s),class:et(`shadow ${h.value?"is-reply":""}`),onKeyup:st(A,["delete"])},"  ",42,yt),[[tt,o(i).commnetInput]])]),x.value?(l(),m("div",$t,[_(H,{html:o(i).previewContent},null,8,["html"])])):N("",!0),t("div",kt,[_(e,{round:"",onClick:L},{default:z(()=>[wt]),_:1}),_(e,{round:"",onClick:g[1]||(g[1]=s=>f(r.ruleFormRef))},{default:z(()=>[xt]),_:1})])])]),(l(!0),m(O,null,W(d.comments,s=>(l(),m("div",{class:"list",key:s.id},[t("div",Ct,[_(b,{size:50,src:s.user.avatar_url,onClick:n=>w(s.user.html_url)},null,8,["src","onClick"]),t("div",bt,[t("div",It,[t("span",St,v(s.user.name),1),t("span",Ht,v(o(D)(s.created_at)),1),t("span",{class:"reply",title:"\u56DE\u590D",onClick:n=>a(s,2)},Nt,8,At)]),t("div",zt,[_(H,{html:s.content},null,8,["html"])])])]),(l(!0),m(O,null,W(s.childComments,n=>(l(),m("div",{class:"child-comment",key:n.id},[_(b,{size:50,src:n.user.avatar_url,onClick:K=>w(s.user.html_url)},null,8,["src","onClick"]),t("div",Dt,[t("div",Lt,[t("span",Mt,v(n.user.name),1),t("span",Tt,v(o(D)(n.created_at)),1),t("span",{class:"reply",title:"\u56DE\u590D",onClick:K=>a(n,3)},Et,8,Vt)]),n.show?(l(),m("div",Ut,[t("div",qt,[t("span",Rt,"@"+v(n.to_user.name),1),t("span",Kt,v(o(D)(n.created_at)),1)]),t("div",Ft,[_(H,{html:n.to_user_content},null,8,["html"])])])):N("",!0),t("div",Pt,[_(H,{html:n.content},null,8,["html"])])])]))),128))]))),128)),o(M)?(l(),m("div",Gt,[t("span",{onClick:T},"\u52A0\u8F7D\u66F4\u591A")])):N("",!0)])}}};var Ot=U(Jt,[["__scopeId","data-v-236b2b8d"]]),Wt="/assets/head-bg.6c0b5954.png";const R=u=>(X("data-v-e4003d3a"),u=u(),Q(),u),Xt={key:1},Qt={class:"wraper"},Yt={class:"image-slot"},Zt={class:"article-header"},te=R(()=>t("div",{class:"head-bg"},null,-1)),ee={class:"title-box"},se={class:"title"},ae={class:"title-name"},oe={class:"info"},ne={class:"article-info"},ce=R(()=>t("i",{class:"iconfont icondate"},null,-1)),le=R(()=>t("i",{class:"iconfont iconfenlei1"},null,-1)),ie={class:"source"},re=$("source: "),de={class:"source-name"},_e={class:"article-content"},ue={class:"star"},me={setup(u){const p=new G,d=B(()=>p.state.userinfo),i=B(()=>p.state.status),h=nt(),{proxy:c}=lt(),f=S(!0),a=I({article:{},comments:[]}),A=async()=>{const e={user_id:i.value?d.value.id:null};f.value=!0;const s=h.params.id,{data:n}=await c.$axios.get("/api/article/"+s,{params:e});a.article=n.data,C.value=a.article.star,f.value=!1,x()};A();const w=I({pagenum:1,pagesize:2}),y=S(0),x=async()=>{const{data:e}=await c.$axios.get("/api/comments/"+a.article.id,{params:w});a.comments=e.data.data,y.value==0?e.data.total:y.value+1},L=async()=>{const{data:e}=await c.$axios.get("/api/comments/"+a.article.id,{params:w});e.data.data,a.comments=[...a.comments,...e.data.data],y.value=e.data.total},M=()=>{w.pagenum++,L()},T=async e=>{const s={article_id:a.article.id,user_id:d.value.id,to_user_id:"",content:"",level:1,to_comment_id:e.to_comment_id};s.content=e.content,s.to_user_id=e.to_user_id,s.level=e.level;const{data:n}=await c.$axios.post("/api/comment",s);if(n.meta.status==200)return p.commit("setCommentIsNull",!0),x(),k.success("\u8BC4\u8BBA\u6210\u529F")},C=S(!1),V=async()=>{if(i.value){const e={user_id:d.value.id,article_id:a.article.id},{data:s}=await c.$axios.post("/api/star",e);if(s.meta.status!=200)return k.error(s.meta.msg);k.success("\u6536\u85CF\u6210\u529F"),C.value=!0}else k.error("\u8BF7\u5148\u767B\u5F55")},r=async()=>{const{data:e}=await c.$axios.delete("/api/delStar"+a.article.star);if(e.meta.status!=200)return k.error(e.meta.msg);k.success("\u53D6\u6D88\u6536\u85CF\u6210\u529F"),C.value=!1},g=J(),b=e=>{g.push({name:"CategoryDetail",params:{id:e}})};return j(()=>p.state.status,e=>A()),(e,s)=>{const n=ct;return f.value?(l(),E(rt,{key:0})):(l(),m("div",Xt,[_(it,null,{default:z(()=>[t("article",null,[t("div",Qt,[_(n,{fit:"cover",src:o(a).article.img_url},{error:z(()=>[t("div",Yt,[_(n,{src:o(Y).defaultImgUrl,fit:"cover"},null,8,["src"])])]),_:1},8,["src"])]),t("div",Zt,[_(n,{fit:"cover",src:o(Wt)},null,8,["src"]),te,t("div",ee,[t("div",se,[t("div",ae,v(o(a).article.title),1)]),t("div",oe,[t("div",ne,[t("span",null,[ce,$(" "+v(o(D)(o(a).article.created_at)),1)]),t("span",{onClick:s[0]||(s[0]=K=>b(o(a).article.category_id)),class:"category_name"},[le,$(v(o(a).article.category_name),1)])]),t("div",ie,[re,t("span",de,v(o(a).article.img_source),1)])])])]),t("div",_e,[_(H,{html:o(a).article.content},null,8,["html"])])])]),_:1}),t("div",ue,[C.value?(l(),m("i",{key:0,class:"iconfont iconstarton stared",title:"\u53D6\u6D88\u6536\u85CF",onClick:r})):(l(),m("i",{key:1,class:"iconfont iconstaroff",title:"\u6536\u85CF",onClick:V}))]),_(Ot,{onSaveComment:T,user:o(d),comments:o(a).comments,total:y.value,onLoadAdd:M},null,8,["user","comments","total"])]))}}};var $e=U(me,[["__scopeId","data-v-e4003d3a"]]);export{$e as default};
